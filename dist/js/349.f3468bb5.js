"use strict";(self["webpackChunktoutiao_lianxi"]=self["webpackChunktoutiao_lianxi"]||[]).push([[349],{9349:function(t,a,s){s.r(a),s.d(a,{default:function(){return w}});var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"detail"},[a("van-nav-bar",{attrs:{title:"文章详情","left-arrow":""},on:{"click-left":function(a){return t.$router.push("/layout/home")}}}),a("div",{staticClass:"content"},[a("h2",[t._v(t._s(t.artObj.title))]),a("div",{staticClass:"author"},[a("van-image",{attrs:{width:"50",height:"50",src:t.artObj.aut_photo,round:"",fit:"cover"}}),a("div",{staticClass:"msg"},[a("div",{staticClass:"name"},[t._v(t._s(t.artObj.aut_name))]),a("div",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(t.artObj.pubdate)))])]),t.artObj.is_followed?a("van-button",{attrs:{type:"info",round:""},on:{click:t.unfollow}},[a("van-icon",{attrs:{name:"success"}}),t._v("已关注")],1):a("van-button",{attrs:{type:"info",round:""},on:{click:t.follow}},[a("van-icon",{attrs:{name:"plus"}}),t._v("关注")],1)],1),a("div",{staticClass:"article",domProps:{innerHTML:t._s(t.artObj.content)}}),a("van-divider",{style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"}},[t._v(" end ")]),a("div",{staticClass:"btn"},[1===t.artObj.attitude?a("van-button",{staticClass:"one",attrs:{round:"",plain:"",type:"primary"}},[a("van-icon",{attrs:{name:"good-job-o"}}),t._v("点赞 ")],1):a("van-button",{staticClass:"one",attrs:{round:"",plain:""}},[a("van-icon",{attrs:{name:"good-job-o"}}),t._v("点赞 ")],1),0===t.artObj.attitude?a("van-button",{attrs:{round:"",plain:"",type:"danger"}},[a("van-icon",{attrs:{name:"delete-o"}}),t._v("不喜欢 ")],1):a("van-button",{attrs:{round:"",plain:""}},[a("van-icon",{attrs:{name:"delete-o"}}),t._v("不喜欢 ")],1)],1)],1),a("comment")],1)},n=[],e=function(){var t=this,a=t._self._c;return a("div",{staticClass:"comment"},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},t._l(t.list,(function(s,i){return a("van-cell",{key:i,scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"item"},[a("van-image",{attrs:{width:"40",height:"40",src:s.aut_photo,round:"",fit:"cover"}}),a("div",{staticClass:"msg"},[a("div",{staticClass:"name"},[t._v(t._s(s.aut_name))]),a("div",{staticClass:"content"},[t._v(t._s(s.content))]),a("div",{staticClass:"other"},[a("span",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(s.pubdate)))]),a("van-button",{attrs:{size:"mini"},on:{click:function(a){return t.openReply(s)}}},[t._v("回复（"+t._s(s.reply_count)+"）")])],1)]),a("van-icon",{attrs:{name:"like-o"}})],1)]},proxy:!0}],null,!0)})})),1),a("van-field",{staticClass:"myfield",attrs:{clearable:"",placeholder:"请输入评论"},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{attrs:{size:"small",type:"info"},on:{click:t.sendComment}},[t._v("发布")])]},proxy:!0}]),model:{value:t.content,callback:function(a){t.content=a},expression:"content"}}),a("van-action-sheet",{attrs:{title:"发表回复"},model:{value:t.replyShow,callback:function(a){t.replyShow=a},expression:"replyShow"}},[t.replyShow?a("reply",{attrs:{item:t.item}}):t._e()],1)],1)},o=[],l=s(2746),r=function(){var t=this,a=t._self._c;return a("div",{staticClass:"reply"},[a("van-cell-group",[a("van-cell",{scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"item"},[a("van-image",{attrs:{width:"40",height:"40",src:t.item.aut_photo,round:"",fit:"cover"}}),a("div",{staticClass:"msg"},[a("div",{staticClass:"name"},[t._v(t._s(t.item.aut_name))]),a("div",{staticClass:"content"},[t._v(t._s(t.item.content))]),a("div",{staticClass:"other"},[a("span",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(t.item.pubdate))+" ")])])])],1)]},proxy:!0}])})],1),a("van-divider",{style:{color:"#1989fa",borderColor:"#1989fa",padding:"0 16px"}},[t._v(" 全部回复 ")]),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}},t._l(t.replyList,(function(s,i){return a("van-cell",{key:i,scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"item"},[a("van-image",{attrs:{width:"40",height:"40",src:s.aut_photo,round:"",fit:"cover"}}),a("div",{staticClass:"msg"},[a("div",{staticClass:"name"},[t._v(t._s(s.aut_name))]),a("div",{staticClass:"content"},[t._v(t._s(s.content))]),a("div",{staticClass:"other"},[a("span",{staticClass:"time"},[t._v(" "+t._s(t._f("formatTime")(s.pubdate))+" ")])])])],1)]},proxy:!0}],null,!0)})})),1),a("van-field",{staticClass:"myfield",attrs:{clearable:"",placeholder:"请输入评论"},scopedSlots:t._u([{key:"button",fn:function(){return[a("van-button",{attrs:{size:"small",type:"info"},on:{click:t.sendReply}},[t._v("发布")])]},proxy:!0}]),model:{value:t.content,callback:function(a){t.content=a},expression:"content"}})],1)},d=[],c={props:["item"],data(){return{loading:!1,finished:!1,content:"",offset:void 0,replyList:[],end_id:0}},methods:{async sendReply(){if(""===this.content)return;const t=await(0,l.Ut)({target:this.item.com_id,content:this.content,art_id:this.$route.query.id});this.replyList.unshift(t.data.data.new_obj),this.$toast.success("评论回复成功"),this.content="",this.item.reply_count+=1},async onLoad(){const t=await(0,l.nr)({type:"c",source:this.item.com_id,offset:this.offset,limit:10});this.replyList=[...this.replyList,...t.data.data.results],this.offset=t.data.data.last_id,this.end_id=t.data.data.end_id,this.loading=!1,this.offset===this.end_id&&(this.finished=!0)}}},u=c,h=s(1001),f=(0,h.Z)(u,r,d,!1,null,null,null),v=f.exports,_={components:{reply:v},data(){return{loading:!1,finished:!1,list:[],content:"",art_id:this.$route.query.id,limit:10,offset:void 0,end_id:0,replyShow:!1,item:{}}},methods:{openReply(t){this.replyShow=!0,this.item=t},async sendComment(){if(""===this.content)return;const t=await(0,l.Ut)({target:this.art_id,content:this.content});this.list.unshift(t.data.data.new_obj),this.$toast.success("发布评论成功"),this.content=""},async onLoad(){const t=await(0,l.nr)({type:"a",source:this.art_id,offset:this.offset,limit:this.limit});this.list=[...this.list,...t.data.data.results],this.offset=t.data.data.last_id,this.end_id=t.data.data.end_id,this.loading=!1,this.offset===this.end_id&&(this.finished=!0)}}},m=_,p=(0,h.Z)(m,e,o,!1,null,null,null),y=p.exports,b={components:{comment:y},data(){return{artObj:{}}},methods:{async follow(){await(0,l.Jk)({target:this.artObj.aut_id}),this.$toast.success("收获迷弟一枚"),this.artObj.is_followed=!0},async unfollow(){await(0,l.mO)(this.artObj.aut_id),this.$toast.fail("失去迷弟一枚"),this.artObj.is_followed=!1}},async created(){const t=await(0,l.qK)(this.$route.query.id);this.artObj=t.data.data}},C=b,g=(0,h.Z)(C,i,n,!1,null,null,null),w=g.exports}}]);